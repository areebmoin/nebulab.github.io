<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">

    <title>Awesome MOTDs with Ubuntu - Nebulab</title>
    <meta name="description" content="As computer geeks, we all get a warm and fuzzy feeling when looking at ASCII art and well structured information and it seems that the Ubuntu Community loves...">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@nebulab_it">

    <meta name="twitter:title" content="Awesome MOTDs with Ubuntu - Nebulab">
    <meta name="twitter:description" content="As computer geeks, we all get a warm and fuzzy feeling when looking at ASCII art and well structured information and it seems that the Ubuntu Community loves...">
    <meta name="twitter:image" content="/blog/images/articles-images/awesome-motds-with-ubuntu/ubuntu-5ee6771f.jpg">

        <meta property="twitter:creator" content="@matteolatini">
      <meta name="twitter:label1" content="Reading Time">
      <meta name="twitter:data1" content="5 minutes">

    <meta property="article:publisher" content="https://www.facebook.com/teamnebulab/">
    <meta property="og:title" content="Awesome MOTDs with Ubuntu - Nebulab by Matteo Latini" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="http://nebulab.it/blog/awesome-motds-with-ubuntu/" />
    <meta property="og:image" content="/blog/images/articles-images/awesome-motds-with-ubuntu/ubuntu-5ee6771f.jpg" />
    <meta property="og:description" content="As computer geeks, we all get a warm and fuzzy feeling when looking at ASCII art and well structured information and it seems that the Ubuntu Community loves..." />
    <meta property="og:site_name" content="Nebulab" />
    <meta property="fb:admins" content="244455778929654" />

    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": "Nebulab",
        "url": "http://nebulab.it",
        "logo": "http://nebulab.it/assets/images/public/logo.svg",
        "contactPoint": {
          "@type": "ContactPoint",
          "telephone": "+39-085-57296",
          "email": "hello@nebulab.it",
          "contactType": "sales",
          "availableLanguage": ["English", "Italian"]
        },
        "sameAs": [
          "https://www.facebook.com/teamnebulab",
          "https://www.instagram.com/teamnebulab",
          "https://twitter.com/nebulab_it",
          "https://www.linkedin.com/company/nebulab",
          "https://github.com/nebulab",
          "https://plus.google.com/108922619281149094352"
        ]
      }
    </script>

    <link href="/assets/images/favicon.ico" rel="icon" type="image/ico" />
    <link rel="apple-touch-icon" href="/assets/images/apple-touch-icon-0eb6fabe.png" />
    <script>
  (function(d) {
    var config = {
      kitId: 'zgl1gmr',
      scriptTimeout: 3000,
      async: false
    },
    h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
  })(document);
</script>

    <!-- Hotjar Tracking Code for http://nebulab.it/ -->
<script>
  (function(h,o,t,j,a,r){
    h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
    h._hjSettings={hjid:434151,hjsv:5};
    a=o.getElementsByTagName('head')[0];
    r=o.createElement('script');r.async=1;
    r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
    a.appendChild(r);
  })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
</script>

    <link href="/assets/stylesheets/application-b7024cb7.css" rel="stylesheet" />
  </head>

  <body class="blog blog_awesome-motds-with-ubuntu blog_awesome-motds-with-ubuntu_index">
    <div class="menu-button">
  <span class="menu-button__line"></span>
  <span class="menu-button__line"></span>
  <span class="menu-button__line"></span>
</div>

<div class="full-menu is-closed">
  <div class="full-menu__content">

  <div class="full-menu__content__logo">
<a href="../../">      <img src="/assets/images/logo_white-1233a304.svg" width="148px" height="45px" alt="Logo white" />
</a>  </div>

  <nav class="full-menu__content__navigation">
    <ul class="full-menu__content__navigation__list">
      <li class="full-menu__content__navigation__list__item">
        <a href="../../" class="full-menu__content__navigation__list__item__link">Home</a>
      </li>
      <li class="full-menu__content__navigation__list__item">
        <a href="/services" class="full-menu__content__navigation__list__item__link">Services</a>
      </li>
      <li class="full-menu__content__navigation__list__item">
        <a href="/about-us" class="full-menu__content__navigation__list__item__link">About us</a>
      </li>
      <li class="full-menu__content__navigation__list__item">
        <a href="/lab" class="full-menu__content__navigation__list__item__link">Lab</a>
      </li>
      <li class="full-menu__content__navigation__list__item">
        <a href="/contact-us" class="full-menu__content__navigation__list__item__link">Contact us</a>
      </li>
      <li class="full-menu__content__navigation__list__item">
        <a href="/blog" class="full-menu__content__navigation__list__item__link">Blog</a>
      </li>
    </ul>
  </nav>

  <div class="full-menu__content__contact">
    <ul class="full-menu__content__contact__list">
      <li class="full-menu__content__contact__list__item">
        <h6>
          Let's talk
        </h6>
      </li>
      <li class="full-menu__content__contact__list__item">
        <a href="mailto:hello@nebulab.it" class="full-menu__content__contact__list__item__link">hello@nebulab.it</a>
      </li>
      <li class="full-menu__content__contact__list__item">
        <a href="tel:+3908557296" class="full-menu__content__contact__list__item__link">(+39) 085 57296</a>
      </li>
    </ul>
    <ul class="full-menu__content__contact__list">
      <li class="full-menu__content__contact__list__item">
        <h6>
          Follow us
        </h6>
      </li>
      <ul class="social-icons">
  <li class="social-icons__item">
    <a href="http://twitter.com/nebulab_it" target="_blank" class="social-icons__item__link"><i class="fa fa-twitter"></i></a>
  </li>
  <li class="social-icons__item">
    <a href="https://www.facebook.com/teamnebulab" target="_blank" class="social-icons__item__link"><i class="fa fa-facebook"></i></a>
  </li>
  <li class="social-icons__item">
    <a href="https://instagram.com/teamnebulab/" target="_blank" class="social-icons__item__link"><i class="fa fa-instagram"></i></a>
  </li>
  <li class="social-icons__item">
    <a href="http://github.com/nebulab" target="_blank" class="social-icons__item__link"><i class="fa fa-github"></i></a>
  </li>
</ul>

    </ul>
  </div>

</div>

</div>

<header class="header">
<a href="../../">      <img src="/assets/images/logo-468b9b26.svg" width="148px" height="45px" class="logo" alt="Logo" />
</a>
  <nav class="main-navigation">
  <ul class="main-navigation__list">
    <li class="main-navigation__list__item">
      <a href="/services" class="main-navigation__list__item__link ">Services</a>
    </li>
    <li class="main-navigation__list__item">
      <a href="/about-us" class="main-navigation__list__item__link ">About us</a>
    </li>
    <li class="main-navigation__list__item">
      <a href="/lab" class="main-navigation__list__item__link ">Lab</a>
    </li>
    <li class="main-navigation__list__item">
      <a href="/contact-us" class="main-navigation__list__item__link ">Contact us</a>
    </li>
    <li class="main-navigation__list__item">
      <a href="/blog" class="main-navigation__list__item__link active">Blog</a>
    </li>
  </ul>
</nav>


</header>


      <section class="blog-page">
    <article class="blog-post">
      <header class="blog-post__header">
        <h1 class="blog-post__header__title">
          Awesome MOTDs with Ubuntu
        </h1>

        <span class="blog-post__header__author">
            <span class="blog-post__header__author__img">
              <img src="/blog/images/authors/matteo-5ece94e8.jpg" alt="Matteo" />
            </span>

          <span class="blog-post__header__author__name">
            Matteo Latini
          </span>
        </span>

        <span class="blog-post__header__tags">
          #Code
        </span>

        <h6 class="blog-post__header__reading-time">
          5 minutes Read
        </h6>
      </header>

        <div class="blog-post__cover">
    <img src="/blog/images/articles-images/awesome-motds-with-ubuntu/ubuntu-5ee6771f.jpg" alt="Awesome MOTDs with Ubuntu" />
  </div>


      <div class="blog-post__body">
        <p>As computer geeks, we all get a warm and fuzzy feeling when looking at ASCII art and well structured information and it seems that the Ubuntu Community loves us so much.</p>

<p>In Ubuntu 10.04 it&rsquo;s been introduced a great and well structured way to build awesome MOTDs. A MOTD or Message Of The Day, is a brief message presented to the user which logs in a console (nowadays mostly via ssh) meant to make the user aware of useful information.</p>

<p>Historically the MOTD was meant for a sysadmin to share information with system users. This meant that che information presented by the MOTD was mostly static and edited by hand by a system administrator.
Times have changed, cloud computing and configuration management tools like <a href="http://www.opscode.com/chef/">Chef</a> and <a href="http://puppetlabs.com/">Puppet</a>, brought the need for a more dynamic MOTD. Ubuntu 10.04 managed to standardize many &ldquo;hacky&rdquo; solutions in one structured and simple solution via <em>pam</em>motd_.</p>

<p>MOTD fragment scripts are stored inside <em>/etc/update-motd.d/</em>, executed at each login, the result of the execution outputted to <em>/var/run/motd</em> which is symlinked by <em>/etc/motd</em>.</p>

<p>For example this is what we have now on production servers:</p>
<pre class="highlight shell"><code><span class="gp">matteo@nebulab:~$ </span>ls /etc/update-motd.d/
0-header  1-info  2-fortune  3-footer
</code></pre>
<p>Each file is prefixed by an integer which will determine the order of execution.</p>

<p>Let&rsquo;s examine each file (we&rsquo;ll skip <em>0-header</em> and <em>3-footer</em> since they&rsquo;re static):</p>
<pre class="highlight shell"><code><span class="gp">matteo@nebulab:~$ </span>cat /etc/update-motd.d/1-info
<span class="c">#!/bin/sh</span>

<span class="nv">UPTIME_DAYS</span><span class="o">=</span><span class="k">$(</span>expr <span class="sb">`</span>cat /proc/uptime | cut -d <span class="s1">'.'</span> -f1<span class="sb">`</span> % 31556926 / 86400<span class="k">)</span>
<span class="nv">UPTIME_HOURS</span><span class="o">=</span><span class="k">$(</span>expr <span class="sb">`</span>cat /proc/uptime | cut -d <span class="s1">'.'</span> -f1<span class="sb">`</span> % 31556926 % 86400 / 3600<span class="k">)</span>
<span class="nv">UPTIME_MINUTES</span><span class="o">=</span><span class="k">$(</span>expr <span class="sb">`</span>cat /proc/uptime | cut -d <span class="s1">'.'</span> -f1<span class="sb">`</span> % 31556926 % 86400 % 3600 / 60<span class="k">)</span>

cat <span class="sh">&lt;&lt; EOF
     %                                                                            %
     %+++++++++++++++++++++++++++++++ SERVER INFO ++++++++++++++++++++++++++++++++%
     %                                                                            %
              Name: nebulab.it
              Uptime: $UPTIME_DAYS days, $UPTIME_HOURS hours, $UPTIME_MINUTES minutes

              CPU: `cat /proc/cpuinfo | grep 'model name' | head -1 | cut -d':' -f2`
              Memory: `free -m | head -n 2 | tail -n 1 | awk {'print $2'}`M
              Swap: `free -m | tail -n 1 | awk {'print $2'}`M
              Disk: `df -h / | awk '{ a = $2 } END { print a }'`
              Distro: `lsb_release -s -d` with `uname -r`

              CPU Load: `cat /proc/loadavg | awk '{print $1 ", " $2 ", " $3}'`
              Free Memory: `free -m | head -n 2 | tail -n 1 | awk {'print $4'}`M
              Free Swap: `free -m | tail -n 1 | awk {'print $4'}`M
              Free Disk: `df -h / | awk '{ a = $2 } END { print a }'`

              Public Address: `ifconfig eth0 | grep "inet addr" | awk -F: '{print $2}' | awk '{print $1}'`
              Cloud Address: `ifconfig eth1 | grep "inet addr" | awk -F: '{print $2}' | awk '{print $1}'`
EOF
</span></code></pre><pre class="highlight shell"><code><span class="gp">matteo@nebulab:~$ </span>cat /etc/update-motd.d/2-fortune
<span class="c">#!/bin/sh</span>

cat <span class="sh">&lt;&lt; EOF
     %                                                                            %
     %+++++++++++++++++++++++++++ WISE WORD OF THE DAY +++++++++++++++++++++++++++%
     %                                                                            %
`/usr/games/fortune -as | sed "s/^/       /"`
     %                                                                            %
EOF
</span></code></pre>
<p>The final result is:</p>
<pre class="highlight shell"><code>                                        |
                                 .     -O-
                      .                 |        <span class="k">*</span>      .     -0-
                             <span class="k">*</span>  o     .    <span class="s1">'       *      .        o
                                    .         .        |      *
                         *             *              -O-          .
                               .             *         |     ,
                                      .           o
                              .---.
                        =   _/__~0_\_     .  *            o       '</span>
                       <span class="o">=</span> <span class="o">=</span> <span class="o">(</span>_________<span class="o">)</span>             .
                                       .                        <span class="k">*</span>
                             <span class="k">*</span>               - <span class="o">)</span> -       <span class="k">*</span>
                                      .               .
                          <span class="k">*</span>     .           <span class="k">*</span>     .--.
                                                 / /  <span class="sb">`</span>      +
                        .       +               | |               o
                                       <span class="s1">'         \ \__,
                        o          *          +   '</span>--<span class="s1">'  *      *
                                       +   /\
                          +              .'</span>  <span class="s1">'.   *         .
                                 *      /======\      +
                                       ;:.  _   ;
                          .            |:. (_)  |    .         +
                                       |:.  _   |
                             +         |:. (_)  |          *     +
                                       ;:.      ;
                                     .'</span> <span class="se">\:</span>.    / <span class="sb">`</span>.    +       <span class="s1">'
                                    / .-'':._.'</span><span class="sb">`</span>-. <span class="se">\</span>
                         <span class="k">*</span>          |/    /||<span class="se">\ </span>   <span class="se">\|</span>        +
                                  _..--<span class="s2">"""</span><span class="sb">````</span><span class="s2">"""</span>--.._
                            _.-<span class="s1">'``                    ``'</span>-._
                          -<span class="s1">'jgs                             '</span>-

     ::::    ::: :::::::::: :::::::::  :::    ::: :::            :::     :::::::::
     :+:+:   :+: :+:        :+:    :+: :+:    :+: :+:          :+: :+:   :+:    :+:
     :+:+:+  +:+ +:+        +:+    +:+ +:+    +:+ +:+         +:+   +:+  +:+    +:+
     +#+ +:+ +#+ +#++:++#   +#++:++#+  +#+    +:+ +#+        +#++:++#++: +#++:++#+
     +#+  +#+#+# +#+        +#+    +#+ +#+    +#+ +#+        +#+     +#+ +#+    +#+
     <span class="c">#+#   #+#+# #+#        #+#    #+# #+#    #+# #+#        #+#     #+# #+#    #+#</span>
     <span class="c">###    #### ########## #########   ########  ########## ###     ### #########</span>

     %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%
     %                                                                            %
     %                                WELCOME!                                    %
     %                                                                            %
     %              This is a Nebulab <span class="o">(</span>http://nebulab.it<span class="o">)</span> server.                 %
     %                                                                            %
     %                                                                            %
     %+++++++++++++++++++++++++++++++ SERVER INFO ++++++++++++++++++++++++++++++++%
     %                                                                            %
              Name: nebulab.it
              Uptime: x days, y hours, z minutes

              CPU:  Quad-Core AMD Opteron<span class="o">(</span>tm<span class="o">)</span> Processor 2374 HE
              Memory: xM
              Swap: yM
              Disk: zG
              Distro: Ubuntu 10.04.3 LTS

              CPU Load: x, y, z
              Free Memory: xM
              Free Swap: yM
              Free Disk: zG

              Public Address: 31.222.165.143
              Cloud Address: x.y.z.k
     %                                                                            %
     %+++++++++++++++++++++++++++ WISE WORD OF THE DAY +++++++++++++++++++++++++++%
     %                                                                            %
       &lt;Addi&gt; Alter.net seems to have replaced one of its router with a zucchini.
     %                                                                            %
     %++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++%
</code></pre>
<p>Which is well, pretty darn sweet!</p>

<p>One piece of advice: you can escape complex ascii characters with:</p>
<pre class="highlight shell"><code>cat <span class="sh">&lt;&lt; 'EOF'
     ::::    ::: :::::::::: :::::::::  :::    ::: :::            :::     :::::::::
     :+:+:   :+: :+:        :+:    :+: :+:    :+: :+:          :+: :+:   :+:    :+:
     :+:+:+  +:+ +:+        +:+    +:+ +:+    +:+ +:+         +:+   +:+  +:+    +:+
     +#+ +:+ +#+ +#++:++#   +#++:++#+  +#+    +:+ +#+        +#++:++#++: +#++:++#+
     +#+  +#+#+# +#+        +#+    +#+ +#+    +#+ +#+        +#+     +#+ +#+    +#+
     #+#   #+#+# #+#        #+#    #+# #+#    #+# #+#        #+#     #+# #+#    #+#
     ###    #### ########## #########   ########  ########## ###     ### #########
EOF
</span></code></pre>
<p>Delimiting <em>EOF</em> with single quotes.</p>

<p>Have fun and tell us what you use MOTD for.</p>

<h3>Useful resources</h3>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Motd_Unix">Wikipedia Motd article</a></li>
<li><a href="http://manpages.ubuntu.com/manpages/lucid/man5/motd.5.html">Ubuntu motd Manpage</a></li>
<li><a href="http://manpages.ubuntu.com/manpages/lucid/man8/pam_motd.8.html">Ubuntu pam_motd Manpage</a></li>
<li><a href="http://www.ascii-art.com/">JGS&rsquo;s ASCII Art</a> from which we took the spaceship! &lt;3 Thanks jgs &lt;3</li>
<li><a href="http://www.figlet.org/">FIGlet an ascii art banner generator</a></li>
<li><a href="http://manpages.ubuntu.com/manpages/lucid/man6/fortune.6.html">Fortune Manpage</a></li>
</ul>

      </div>

      <div class="blog-post__share">
  <h6 class="blog-post__share__title">
    Share
  </h6>

  <ul class="share-links-list js-social-links">
  <li>
    <a href="http://twitter.com/intent/tweet?status=Awesome MOTDs with Ubuntu+http://nebulab.it/blog/awesome-motds-with-ubuntu/ via @nebulab_it">
      <i class='fa fa-twitter'></i>
    </a>
  </li>
  <li>
    <a href="http://www.facebook.com/share.php?u=http://nebulab.it/blog/awesome-motds-with-ubuntu/&title=Awesome MOTDs with Ubuntu">
      <i class='fa fa-facebook'></i>
    </a>
  </li>
  <li>
    <a href="http://www.linkedin.com/shareArticle?mini=true&url=http://nebulab.it/blog/awesome-motds-with-ubuntu/&title=Awesome MOTDs with Ubuntu&source=http://nebulab.it">
      <i class='fa fa-linkedin'></i>
    </a>
  </li>
</ul>

</div>

    </article>
  </section>

  



  <div class="blog-post">
    <div class="blog-post__comments">
  <h2>Join the Conversation</h2>

  <div id="disqus_thread"></div>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

  </div>


    <footer class="footer">
  <div class="footer__content">
    <ul class="footer__content__list">
      <li class="footer__content__list__item">
        <h6>
          Nebulab srls
        </h6>
      </li>
      <li class="footer__content__list__item">
        <a href="mailto:hello@nebulab.it" class="footer__content__list__item__link mail">hello@nebulab.it</a>
      </li>
      <li class="footer__content__list__item">
        <a href="tel:+3908557296" class="footer__content__list__item__link phone">(+39) 085 57296</a>
      </li>
      <li class="footer__content__list__item">
        VAT Number: IT02112180688
      </li>
      <li class="footer__content__list__item">
        <a href="/contact-us#careers" class="footer__content__list__item__link careers-link">Careers</a>
      </li>
      <li class="footer__content__list__item">
        <ul class="social-icons">
  <li class="social-icons__item">
    <a href="http://twitter.com/nebulab_it" target="_blank" class="social-icons__item__link"><i class="fa fa-twitter"></i></a>
  </li>
  <li class="social-icons__item">
    <a href="https://www.facebook.com/teamnebulab" target="_blank" class="social-icons__item__link"><i class="fa fa-facebook"></i></a>
  </li>
  <li class="social-icons__item">
    <a href="https://instagram.com/teamnebulab/" target="_blank" class="social-icons__item__link"><i class="fa fa-instagram"></i></a>
  </li>
  <li class="social-icons__item">
    <a href="http://github.com/nebulab" target="_blank" class="social-icons__item__link"><i class="fa fa-github"></i></a>
  </li>
</ul>

      </li>
    </ul>
    <ul class="footer__content__list">
      <li class="footer__content__list__item">
        <h6>
          Pescara
        </h6>
      </li>
      <li class="footer__content__list__item">
        <a href="https://goo.gl/maps/RGmbCp19mMD2" target="_blank" class="footer__content__list__item__link">Strada Comunale Piana, 1/1 <br> 65129 Pescara <br> Italy</a>
      </li>
    </ul>
    <ul class="footer__content__list">
      <li class="footer__content__list__item">
        <h6>
          Latina
        </h6>
      </li>
      <li class="footer__content__list__item">
        <a href="https://goo.gl/T4pIR1" target="_blank" class="footer__content__list__item__link">Via Ufente, 20 <br> 04100 Latina <br> Italy</a>
      </li>
    </ul>
    <ul class="footer__content__list">
      <li class="footer__content__list__item">
        <h6>
          Start a project
        </h6>
      </li class="footer__content__list__item">
        <h2>
          <a href="/contact-us" class="footer__content__list__item__link">Let's talk</a>
        </h2>
      </li>
    </ul>
  </div>
</footer>


    <div class="cookie-message">
      <p>This site uses cookies. Continuing you accept <a href="/privacy-policy">our terms</a>. &nbsp <a class='close-button'>Close</a></p>
    </div>

    <script src="/assets/javascripts/application-fd819535.js"></script>
      <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-25604808-1"]);
  _gaq.push(["_trackPageview"]);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
  </body>
</html>
